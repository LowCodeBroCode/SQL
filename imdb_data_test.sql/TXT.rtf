{\rtf1\ansi\ansicpg1252\cocoartf2818
\cocoatextscaling0\cocoaplatform0{\fonttbl\f0\froman\fcharset0 Times-Roman;\f1\fmodern\fcharset0 Courier;}
{\colortbl;\red255\green255\blue255;\red0\green0\blue0;}
{\*\expandedcolortbl;;\cssrgb\c0\c0\c0;}
\paperw11900\paperh16840\margl1440\margr1440\vieww19500\viewh14580\viewkind0
\deftab720
\pard\pardeftab720\sa240\partightenfactor0

\f0\fs24 \cf0 \expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 */Show how many titles from each year*/\
\pard\pardeftab720\partightenfactor0

\f1\fs26 \cf0 SELECT DISTINCT releaseyear, count(title)\
FROM imdb_data\
GROUP BY releaseyear\
ORDER BY releaseyear DESC\
\pard\pardeftab720\sa240\partightenfactor0

\f0\fs24 \cf0 /* Show every titles within the Crime genre */\
\pard\pardeftab720\partightenfactor0

\f1\fs26 \cf0 SELECT *\
FROM imdb_data\
WHERE genres LIKE '%Crime%'\
\pard\pardeftab720\sa240\partightenfactor0

\f0\fs24 \cf0 /* Average rating per year of movies with amount */\
\pard\pardeftab720\partightenfactor0

\f1\fs26 \cf0 SELECT releaseyear, ROUND(avg(averagerating),2) as average_rating, count(title) as number_of_movies\
FROM imdb_data\
GROUP BY releaseyear\
ORDER BY releaseyear DESC\
\pard\pardeftab720\sa240\partightenfactor0

\f0\fs24 \cf0 /* Show highest rated movie per year */\
\pard\pardeftab720\partightenfactor0

\f1\fs26 \cf0 WITH RankedMovies AS (\
    SELECT\
        title,\
        releaseyear,\
        averagerating,\
        ROW_NUMBER() OVER (PARTITION BY releaseyear ORDER BY averagerating DESC) AS rank\
    FROM imdb_data\
    WHERE type = 'movie'\
)\
SELECT\
    releaseyear,\
    title,\
    averagerating\
FROM RankedMovies\
WHERE rank = 1\
ORDER BY releaseyear DESC;\
\
/* 
\f0\fs24 Count of each category with more than 9 in average rating and 10,000 votes */ \

\f1\fs26 SELECT type, COUNT(title) AS count\
FROM imdb_data\
WHERE averageRating > 9 AND numvotes > 10000\
GROUP BY type;\
\pard\pardeftab720\sa240\partightenfactor0

\f0\fs24 \cf0 Separating the genres column into 3\
\pard\pardeftab720\partightenfactor0

\f1\fs26 \cf0  select title,\
        split_part(genres, ',', 1) as genre1, \
        split_part(genres, ',', 2) as genre2,\
        split_part(genres, ',', 3) as genre3,\
        averagerating,\
        numvotes,\
        releaseyear\
 from imdb_data\
\
\pard\pardeftab720\sa240\partightenfactor0

\f0\fs24 \cf0 /* Count each category from the genres column */\
\pard\pardeftab720\partightenfactor0

\f1\fs26 \cf0 WITH genre_split AS (\
    SELECT TRIM(BOTH ' ' FROM LOWER(unnest(string_to_array(genres, ',')))) as genre\
    FROM imdb_data\
)\
SELECT genre, COUNT(*) as genre_count\
FROM genre_split\
GROUP BY genre\
ORDER BY genre_count DESC;\
}